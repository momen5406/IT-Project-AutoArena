<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoArena - Repair your Car</title>
    <!-- Font Awesome -->
    <link href="../../css/all.min.css" rel="stylesheet" />
    <!-- Global CSS File -->
    <link rel="stylesheet" href="../../css/global.css">
    <!-- CSS File -->
    <link rel="stylesheet" href="../../css/shopping.css">
    
 </head>

  <body>
    <!-- Start Nav -->
    <nav>
      <div class="container">
        <h1 class="logo"><span>A</span>uto<span>A</span>rena</h1>
        <ul id="menu">
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../gallery.html">Browse Cars</a></li>
          <li><a href="../mechanic.html">Book Mechanic</a></li>
          <li><a href="../repair.html" class="active">Auto Parts</a></li>
          <li><a href="../news.html">News</a></li>
          <li><a href="../about.html">About US</a></li>
        </ul>
        <i id="menu-button" class="fa-solid fa-bars menu-icon"></i>
      </div>
    </nav>
    <!-- End Nav -->
    </header>	
		</div>
    
    <!-- Cart Icon -->
    <div class="cart-icon" id="cart-icon">
      <i class="fa-solid fa-cart-shopping"></i>
      <span class="cart-count" id="cart-count">0</span>
    </div>
    
    <!-- Cart Container -->
    <div class="cart-container" id="cart-container">
      <div class="cart-header">
        <h2>Your Cart</h2>
        <div class="close-cart" id="close-cart">
          <i class="fa-solid fa-times"></i>
        </div>
      </div>
      <div class="cart-items" id="cart-items">
        <!-- Cart items will be added here dynamically -->
      </div>
      <div class="empty-cart-message" id="empty-cart-message">
        Your cart is empty
      </div>
      <div class="cart-summary" id="cart-summary">
        <div class="summary-row">
          <span>Subtotal:</span>
          <span id="cart-subtotal">0.00 EGP</span>
        </div>
        <div class="summary-row">
          <span>Tax (14%):</span>
          <span id="cart-tax">0.00 EGP</span>
        </div>
        <div class="summary-row cart-total">
          <span>Total:</span>
          <span id="cart-total">0.00 EGP</span>
        </div>
      </div>
      <div class="cart-buttons">
        <button class="checkout-btn" id="checkout-btn">Checkout</button>
        <button class="clear-cart-btn" id="clear-cart-btn">Clear All</button>
      </div>
    </div>
    
    <!-- Checkout Modal -->
    <div class="checkout-modal" id="checkout-modal">
      <div class="close-modal" id="close-modal">
        <i class="fa-solid fa-times"></i>
      </div>
      <div class="checkoutLayout">
        <div class="returnCart">
          <h1>Order Summary</h1>
          <div class="list">
            <!-- Cart items will be displayed here -->
          </div>
          <div class="total">
            <div class="totalQuantity">0</div>
            <div class="totalPrice">EGP0</div>
          </div>
        </div>
        <div class="right">
          <form class="form">
            <h1>Checkout</h1>
            <div class="group">
              <label for="name">Full Name</label>
              <input type="text" id="name" required>
            </div>
            <div class="group">
              <label for="email">Email</label>
              <input type="email" id="email" required>
            </div>
            <div class="group">
              <label for="phone">Phone</label>
              <input type="tel" id="phone" required>
            </div>
            <div class="group">
              <label for="city">City</label>
              <input type="text" id="city" required>
            </div>
            <div class="group">
              <label for="district">District</label>
              <input type="text" id="district" required>
            </div>
            <div class="group">
              <label for="address">Address</label>
              <input type="text" id="address" required>
            </div>
            <div class="group">
              <label for="payment">Payment Method</label>
              <select id="payment" required>
                <option value="">Select Payment Method</option>
                <option value="cash">Cash on Delivery</option>
                <option value="credit">Credit Card</option>
                <option value="paypal">PayPal</option>
              </select>
            </div>
          </form>
          <div class="return">
            <div class="row">
              <div>Subtotal</div>
              <div id="checkout-subtotal">EGP0</div>
            </div>
            <div class="row">
              <div>Tax (14%)</div>
              <div id="checkout-tax">EGP0</div>
            </div>
            <div class="row">
              <div>Shipping</div>
              <div id="checkout-shipping">EGP10</div>
            </div>
            <div class="row">
              <div>Total</div>
              <div id="checkout-total">EGP0</div>
            </div>
            <button class="submit-order" id="submit-order">Place Order</button>
          </div>
        </div>
      </div>
    </div>
    
		<!--button -->
		 <a href="../repair.html" class="go_back">
			<span class="text"> <    Go Back  </span>
		 </a>
		<!-- card container -->
		<div class="products-container" id="products-container">
      <!-- Products will be dynamically loaded here -->
    </div>

    <!-- Start Footer -->
    <footer>
      <div class="container">
          <div class="row">
              <div class="links">
                  <h4>Website Links:</h4>
                  <ul>
                      <li><a href="index.html">Home</a></li>
                      <li><a href="pages/gallery.html">Browse Cars</a></li>
                      <li><a href="pages/mechanic.html">Book a Mechanic</a></li>
                      <li><a href="pages/repair.html">Auto Parts</a></li>
                      <li><a href="pages/news.html">News</a></li>
                      <li><a href="pages/about.html">About US</a></li>
                  </ul>
              </div>

              <div class="social">
                  <h4>Social Links:</h4>
                  <div class="icons">
                      <a href="#"><i class="fa-brands fa-facebook"></i></a> 
                      <a href="#"><i class="fa-brands fa-instagram"></i></a> 
                      <a href="#"><i class="fa-brands fa-twitter"></i></a>
                      <a href="#"><i class="fa-brands fa-linkedin"></i> </a>
                  </div>
              </div>

              <div class="contact">
                  <h4>Give us a Feedback:</h4>
                  <div class="link">
                      <a href="pages/about.html#contact" class="special-link">Contact US</a>
                  </div>
              </div>
          </div>
          <div class="copyrights-link">
              <p class="github">Github Repo: <a href="https://github.com/momen5406/IT-Project-AutoArena" target="_blank"><i class="fa-brands fa-github"></i></a></p>
              <p class="copyrights">Copy Right 2025 &copy; By <span>FCAIH Team</span>. All Rights Reserved</p>
          </div>
      </div>
  </footer>
  <!-- End Footer -->

    <!-- Product Data -->
    <script>
      // Product data in JSON format
      const productsData = [
       {
    "name": "Michelin Pilot Sport 4",
    "price": 5500.00,
    "rating": 4.9,
    "image": "../../images/products/michelin-tire.jpg",
    "description": "235/45R18 94Y, high-performance tread, excellent wet grip.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Goodyear Eagle F1",
    "price": 4800.00,
    "rating": 4.8,
    "image": "../../images/products/goodyear-tire.jpg",
    "description": "225/50R17 98W, asymmetric tread, sport handling.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Bridgestone Turanza T005",
    "price": 4200.00,
    "rating": 4.7,
    "image": "../../images/products/bridgestone-tire.jpg",
    "description": "205/55R16 91V, low noise, long tread life.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Pirelli P Zero",
    "price": 6000.00,
    "rating": 4.9,
    "image": "../../images/products/pirelli-tire.jpg",
    "description": "245/40R19 94Y, ultra-high performance, track-ready.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Continental ContiSportContact 5",
    "price": 5200.00,
    "rating": 4.7,
    "image": "../../images/products/continental-tire.jpg",
    "description": "255/35R20 97Y, sport handling, reinforced sidewalls.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Dunlop SP Sport Maxx",
    "price": 3800.00,
    "rating": 4.6,
    "image": "../../images/products/dunlop-tire.jpg",
    "description": "215/60R16 95V, responsive steering, all-season traction.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Yokohama Advan Sport",
    "price": 4500.00,
    "rating": 4.7,
    "image": "../../images/products/yokohama-tire.jpg",
    "description": "225/40R18 92W, silica compound, wet/dry performance.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Hankook Ventus Prime 3",
    "price": 3200.00,
    "rating": 4.5,
    "image": "../../images/products/hankook-tire.jpg",
    "description": "195/65R15 91H, fuel-efficient, comfortable ride.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Toyo Proxes T1",
    "price": 4000.00,
    "rating": 4.6,
    "image": "../../images/products/toyo-tire.jpg",
    "description": "235/55R17 99W, sport SUV tire, 3D sipes for grip.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
  {
    "name": "Kumho Ecsta PS71",
    "price": 2800.00,
    "rating": 4.4,
    "image": "../../images/products/kumho-tire.jpg",
    "description": "205/50R16 87W, asymmetric pattern, budget performance.",
    "category": "Car Tires",
    "availability": "In Stock"
  },
      ];



			// Cart functionality
let cart = [];
let listCart = [];


// Function to save cart to localStorage
function saveCartToStorage() {
    localStorage.setItem('cart', JSON.stringify(cart));
    localStorage.setItem('listCart', JSON.stringify(listCart));
}

// Function to load cart from localStorage
function loadCartFromStorage() {  // Added new function
    const savedCart = localStorage.getItem('cart');
    const savedListCart = localStorage.getItem('listCart');

    if (savedCart) {
        cart = JSON.parse(savedCart);
    }

    if (savedListCart) {
        listCart = JSON.parse(savedListCart);
    }
}

function updateCartDisplay() {
    const cartItems = document.getElementById('cart-items');
    const cartCount = document.getElementById('cart-count');
    const emptyCartMessage = document.getElementById('empty-cart-message');
    const cartSummary = document.getElementById('cart-summary');
    const cartSubtotal = document.getElementById('cart-subtotal');
    const cartTax = document.getElementById('cart-tax');
    const cartTotal = document.getElementById('cart-total');

    // Update cart count
    cartCount.textContent = cart.reduce((total, item) => total + item.quantity, 0);

    // Clear cart items
    cartItems.innerHTML = '';

    if (cart.length === 0) {
        emptyCartMessage.style.display = 'block';
        cartSummary.style.display = 'none';
    } else {
        emptyCartMessage.style.display = 'none';
        cartSummary.style.display = 'block';

        // Add items to cart
        cart.forEach((item, index) => {
            const cartItem = document.createElement('div');
            cartItem.className = 'cart-item';

            cartItem.innerHTML = `
           <img src="${item.image}" alt="${item.name}">
           <div class="cart-item-details">
             <div class="cart-item-name">${item.name}</div>
             <div class="cart-item-price">${item.price} EGP</div>
             <div class="cart-item-quantity">
               <button class="quantity-btn minus" data-index="${index}">-</button>
               <span class="quantity-value">${item.quantity}</span>
               <button class="quantity-btn plus" data-index="${index}">+</button>
               <span class="remove-item" data-index="${index}">Remove</span>
             </div>
           </div>
         `;

            cartItems.appendChild(cartItem);
        });

        // Calculate totals
        const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
        const tax = subtotal * 0.14;
        const total = subtotal + tax;

        cartSubtotal.textContent = subtotal.toFixed(2) + ' EGP';
        cartTax.textContent = tax.toFixed(2) + ' EGP';
        cartTotal.textContent = total.toFixed(2) + ' EGP';

        // Add event listeners to quantity buttons and remove buttons
        document.querySelectorAll('.quantity-btn.minus').forEach(btn => {
            btn.addEventListener('click', function () {
                const index = parseInt(this.getAttribute('data-index'));
                if (cart[index].quantity > 1) {
                    cart[index].quantity--;
                    updateCartDisplay();
                    saveCartToStorage();
                }
            });
        });

        document.querySelectorAll('.quantity-btn.plus').forEach(btn => {
            btn.addEventListener('click', function () {
                const index = parseInt(this.getAttribute('data-index'));
                cart[index].quantity++;
                updateCartDisplay();
                saveCartToStorage();
            });
        });

        document.querySelectorAll('.remove-item').forEach(btn => {
            btn.addEventListener('click', function () {
                const index = parseInt(this.getAttribute('data-index'));
                cart.splice(index, 1);
                updateCartDisplay();
                saveCartToStorage();
            });
        });
    }

    // Update listCart for checkout
    listCart = cart.map(item => ({
        name: item.name,
        price: item.price,
        image: item.image,
        quantity: item.quantity
    }));

    // Save to localStorage instead of cookies
    saveCartToStorage();
}

function addToCart(product) {
    const existingItem = cart.find(item => item.name === product.name);

    if (existingItem) {
        existingItem.quantity++;
    } else {
        cart.push({
            ...product,
            quantity: 1
        });
    }

    updateCartDisplay();
    saveCartToStorage();
}

function checkCart() {
    // Changed from cookie parsing to localStorage
    loadCartFromStorage();
}

function addCartToHTML() {
    // clear data default
    let listCartHTML = document.querySelector('.returnCart .list');
    listCartHTML.innerHTML = '';

    let totalQuantityHTML = document.querySelector('.totalQuantity');
    let totalPriceHTML = document.querySelector('.totalPrice');
    let checkoutSubtotal = document.getElementById('checkout-subtotal');
    let checkoutTax = document.getElementById('checkout-tax');
    let checkoutShipping = document.getElementById('checkout-shipping');
    let checkoutTotal = document.getElementById('checkout-total');

    let totalQuantity = 0;
    let totalPrice = 0;

    // if has product in Cart
    if (listCart && listCart.length > 0) {
        listCart.forEach(product => {
            if (product) {
                let newCart = document.createElement('div');
                newCart.classList.add('item');
                newCart.innerHTML =
                    `<img src="${product.image}">
             <div class="info">
               <div class="name">${product.name}</div>
               <div class="price">EGP${product.price}/1 product</div>
             </div>
             <div class="quantity">${product.quantity}</div>
             <div class="returnPrice">EGP${(product.price * product.quantity).toFixed(2)}</div>`;
                listCartHTML.appendChild(newCart);
                totalQuantity = totalQuantity + product.quantity;
                totalPrice = totalPrice + (product.price * product.quantity);
            }
        });
    }

    totalQuantityHTML.innerText = totalQuantity + ' items';
    totalPriceHTML.innerText = 'EGP' + totalPrice.toFixed(2);

    const tax = totalPrice * 0.14;
    const shipping = 10;
    const total = totalPrice + tax + shipping;

    checkoutSubtotal.innerText = 'EGP' + totalPrice.toFixed(2);
    checkoutTax.innerText = 'EGP' + tax.toFixed(2);
    checkoutShipping.innerText = 'EGP' + shipping.toFixed(2);
    checkoutTotal.innerText = 'EGP' + total.toFixed(2);
}

// Function to render products
function renderProducts(products) {
    const container = document.getElementById('products-container');
    container.innerHTML = ''; // Clear container

    products.forEach(product => {
        const productCard = document.createElement('div');
        productCard.className = 'product-card';

        productCard.innerHTML = `
         <div class="card-inner">
           <div class="card-front">
             <img src="${product.image}" alt="${product.name}" class="product-image">
             <h2 class="product-name">${product.name}</h2>
             <p class="product-price">${product.price} egp</p>
             <div class="rating">
               <span class="rating-text">${product.rating}/5</span>
             </div>
           </div>
           <div class="card-back">
             <h2 class="product-name">${product.name}</h2>
             <p class="product-description">
               ${product.description}
             </p>
             <div class="product-details">
               <div class="detail-item">
                 <span class="detail-label">Category:</span>
                 <span class="detail-value">${product.category}</span>
               </div>
               <div class="detail-item">
                 <span class="detail-label">Availability:</span>
                 <span class="detail-value">${product.availability}</span>
               </div>
               <div class="detail-item">
                 <span class="detail-label">Rating:</span>
                 <span class="detail-value">${product.rating}/5</span>
               </div>
             </div>
             <button class="buy-button">Add to Cart</button>
           </div>
         </div>
       `;

        container.appendChild(productCard);

        // Add event listener to the buy button
        const buyButton = productCard.querySelector('.buy-button');
        buyButton.addEventListener('click', () => {
            addToCart(product);
        });
    });
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function () {
    // Load cart from localStorage first
    loadCartFromStorage();  // Added to load cart data on page load

    renderProducts(productsData);

    // Cart toggle functionality
    const cartIcon = document.getElementById('cart-icon');
    const cartContainer = document.getElementById('cart-container');
    const closeCart = document.getElementById('close-cart');
    const clearCartBtn = document.getElementById('clear-cart-btn');
    const checkoutBtn = document.getElementById('checkout-btn');
    const checkoutModal = document.getElementById('checkout-modal');
    const closeModal = document.getElementById('close-modal');
    const submitOrderBtn = document.getElementById('submit-order');

    cartIcon.addEventListener('click', function () {
        cartContainer.classList.add('active');
    });

    closeCart.addEventListener('click', function () {
        cartContainer.classList.remove('active');
    });

    clearCartBtn.addEventListener('click', function () {
        cart = [];
        listCart = [];
        updateCartDisplay();
        saveCartToStorage();
    });

    checkoutBtn.addEventListener('click', function () {
        if (cart.length > 0) {
            checkCart();
            addCartToHTML();
            checkoutModal.classList.add('active');
            cartContainer.classList.remove('active');
        } else {
            alert('Your cart is empty. Please add items before checking out.');
        }
    });

    closeModal.addEventListener('click', function () {
        checkoutModal.classList.remove('active');
    });

    submitOrderBtn.addEventListener('click', function (e) {
        e.preventDefault();
        const form = document.querySelector('.form');
        if (form.checkValidity()) {
            alert('Thank you for your order! Your purchase has been completed successfully.');
            cart = [];
            listCart = [];
            updateCartDisplay();
            saveCartToStorage();  // Added to save changes
            checkoutModal.classList.remove('active');
        } else {
            alert('Please fill in all required fields before placing your order.');
        }
    });

    // Initialize cart display
    checkCart();
    updateCartDisplay();
});
    </script>

    <!-- JS File -->
    <script src="../../js/global.js"></script>
  </body>
</html>



